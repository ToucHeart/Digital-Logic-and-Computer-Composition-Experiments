
//=======================================================
//  This code is generated by Terasic System Builder
//=======================================================

module exp4
	(

	//////////// CLOCK //////////
	input 		     CLOCK_50,

	//////////// KEY //////////
	input 		     [3:0]		KEY,

	//////////// SW //////////
	input 		     [4:0]		SW,

	//////////// LED //////////
	output		     [9:0]		LEDR,

	//////////// Seg7 //////////
	output		     [6:0]		HEX0,
	output		     [6:0]		HEX1,
	output		     [6:0]		HEX2,
	output		     [6:0]		HEX3,
	output		     [6:0]		HEX4,
	output		     [6:0]		HEX5
	);
	assign LEDR[9:1]=9'b0;
	

	wire [5:0] norHour,norMin,norSec;
   wire [5:0] stoHour,stoMin,stoSec;
	wire  [5:0] alaHour,alaMin,alaSec;//保存设定闹钟的值
	
	reg ala;
	reg [5:0] hour,min,sec;
	
	initial
	begin
		ala=0;
		hour=0;min=0;sec=0;
	end
	
	bcd7seg hh(hour/10,HEX5),hl(hour%10,HEX4),minh(min/10,HEX3),minl(min%10,HEX2),sech(sec/10,HEX1),secl(sec%10,HEX0);
	
	normClock myclock(CLOCK_50,KEY[3:0],norHour,norMin,norSec);
	Stopwatch mywatch(CLOCK_50,SW[2],SW[3],stoHour,stoMin,stoSec);
	alarm myalarm(CLOCK_50,SW[1:0],KEY[2:0],ala,alaHour,alaMin,alaSec,LEDR[0]);
	
	

	always@(*)
	begin
		if(SW[1:0]==2'b00||SW[1:0]==2'b11)//正常时钟模式
		begin
			hour=norHour;
            min=norMin;
            sec=norSec;
			if((SW[4]==1)&&(alaHour==norHour)&&(alaMin<=norMin)&&(norMin<alaMin+3))//是否打开了闹钟
			begin
				ala=1;
			end
			else
				ala=0;
		end
		else if(SW[1:0]==2'b01)//秒表模式
		begin
				hour=stoHour;
            min=stoMin;
            sec=stoSec;
				ala=0;
		end
		else if(SW[1:0]==2'b10)//闹钟模式
		begin
				hour=alaHour;
            min=alaMin;
            sec=alaSec;
				ala=0;
		end
	end			
endmodule





/*在 DE-10 Standard 开发板上实现一个电子时钟，时钟要求能够显示时、
分、秒；还可以有以下功能：调整时间；闹铃（在特定时间 LED 闪烁）；秒表
（提供百分之一秒精度，可以停止重启）等。*/
